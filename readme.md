## ДелиЧек
[ДелиЧек](https://deli-check.ru) - сервис для деления счета в ресторане или кафе.  
https://deli-check.ru/
-

### Общая информация:

- Состоит из [API](https://api.deli-check.ru/swagger/index.html) и [веб-приложения](https://deli-check.ru)
- Написан на языке C# с использование [ASP.NET Web Api](https://dotnet.microsoft.com/en-us/apps/aspnet/apis) и [Blazor Web Assembly](https://dotnet.microsoft.com/en-us/apps/aspnet/web-apps/blazor)
- Распознавание чека с помощью [aspose.ai](https://products.aspose.ai/total/ru/image-to-text/) и базы данных ФНС
- Интеграция с [ВКонтакте](https://vk.com) (синхронизация списка друзей и данных профиля)

### Перспективы:
 - Разработка нативных приложений для Android и IOS
 - Улучшение алгоритмов OCR для распознавания чека
 - Улучшение дизайна веб-приложения
 - Интеграция с различными сервисами, например, экосистема СБЕР

### Обоснование выбора технологий
- .NET, Blazor Web Assembly и язык C# был выбран из-за того, что наша команда лучше всего владеет именно этими технологиями. ASP.NET Web Api предоставляет очень широкие возможности для разработки, к тому же, это кроссплатформенная технология, многие крупные сайты и приложения используют именно ASP.NET. Технология динамично развивается и может быть развернута даже в Docker. Blazor Web Assembly был выбран из-за скорости разработки. Имея очень сжатые сроки, вы выбрали именно его. Использование уже готовой кодовой базы на C# с моделями объектов, использующихся в API ускоряет разработку. Библиотека Radzen для Blazor предоставляет возможность быстро разработать довольно сложный UI. В дальнейшем, можно использовать другой фреймворк для Web-приложения, либо перейти на нативные приложения для мобильных устройств.
- Критерии для выбора Aspose.ai - его бесплатность и довольно точные резутальтаты распознавания. Многие технологии либо платные, либо требуют довольно мощного сервера, чтобы быстро распознавать текст. К тому же, Aspose используют многие крупные компании, например такие, как Т-Банк. Реализовать свой алгоритм распознавания с использованием open-source инструментов требует более долгих сроков, к тому же мы были больше сфокусированы на самой концепции приложения и его удобства для пользователей.
- Получение данных из ФНС - крайне удобная технология, так как результаты почти со стопроцентной вероятностью точны. Однако, для использования API ФНС требуется юр. лицо либо ИП, которым участники нашей команды не распологают. На просторах интернета был найден сайт https://proverkacheka.com/ Он предоставляет бесплатную возможность проверки чека с помощью данных с налоговой службы. Мы [автомотизировали процесс получения данных](https://github.com/anden-t/DeliCheck/blob/main/DeliCheck.Api/Services/FnsParser.cs), используя реверс-инжениринг, так как данные там были зашифрованы.
- Интеграция с ВКонтакте - Вконтакте предоставляет открытый API для разработчиков, его можно использовать для авторизации, и главный критерий - можно получить список друзей. Это упрощает взаимодействие пользователя с приложением.

## Возможности приложения:
 ### Авторизация
 Приложение нацелено на удобство пользователя, поэтому было разработано несколько способов входа:
 
 - По имени пользователя и паролю
 - Через ВКонтакте
 - Регистрация без ввода имени пользователя и пароля (подойдет например тем, кто всего пару раз воспользуется приложением; пользователь останется авторизированным при следующем входе; для сохранения учетной записи можно привязать профиль Вконтакте)

 ### Список друзей и профиля
 Приложение предоставляет возможность организовать список друзей. Это удобно, если пользователь ходит куда-нибудь поесть зачастую с одними и теми же людьми. 
 - Можно найти аккаунт друга среди всех пользователей по имени и фамилии и добавить его в друзья
 - Если друг не пользуется ДелиЧек, его можно добавить в список, введя его имя и фамилию
 
 Таким образом, приложение не будет ограничено в том случае, если не все участники трапезы пользуются приложением.<br/>
 При авторизации через ВК импортируется список друзей. В этом случае пользователю не придется никого добавлять, а просто выбрать нужных людей при разделении чека.<br/>
 У каждого зарегистрированного пользователя есть свой профиль. Он может изменить отображаемое имя и фамилию, поставить аватарку. Данные профиля тоже синхронизируются с ВКонтакте.<br/>

 ### Чеки
 В меню пользователь может найти пункты **"Мои чеки"** и **"Мои счета"**:
 - На странице **"Мои чеки" пользователь видит все чеки, которые он загружал в приложение**. Можно посмотреть подробную информацию о каждом чеке, кликнув на него
 - На странице **"Мои счета" пользователь видит свои доли в разделенных чеках, то есть сколько и кому он должен**. Рядом с каждым счетом пользователь может указать, что свою долю он заплатил, и тот, кто оплачивал за всех в ресторане, это увидит.

 **Страница чека**<br/>
1. **На странице чека указаны все позиции и итоговая сумма**, список людей, кто разделял в компании друзей вкуснейший ужин.
2. **Рядом с каждым человеком указана сумма, сколько он должен, и оплатил ли он счет** (например, перевел или отдал наличкой). *Тот, кто загрузил чек, может проставлять "Оплачено" за любого человека*
3. Таким образом, для человека, оплатившего ужин в ресторане, **под рукой удобный список со всеми людьми**, и сразу можно увидеть, с кого надо требовать деньги.
4. Доступно **копирование списка в текстовом формате** (можно выслать в чат с друзьями, чтобы все были в курсе)

 **Деление чека**
1. **Пользователь выбирает людей, которые ели с ним**. Выбрать можно из списка друзей или найти человека среди зарегистрированных пользователей.
2. **Пользователь загружает чек в приложение и обрезает его**, чтобы на изображении остался только чек без заднего фона. Алгоритм ищет QR-код фискального чека, и если находит его, получает информацию о позициях в чеке и итоговой сумме через базу данных ФНС. Это идеальный вариант развития событий, потому что, получая данные из ФНС, вероятность ошибки в стоимосте позиций и общей сумме приближается к нулю. Однако, в настоящий момент рестораны и другие заведения общепита могут выдавать пречеки - это не фискальный документ, поэтому QR-кода там не будет. В таком случае алгоритм распознает текст на чеке и формирует список позиций и итоговую стоимость.
3. **На экран выводится список позиций и итоговая сумма.** Если программа некорректно распознала какую-либо часть чека, пользователь может это поправить.
4. **Пользователь указывает список позиций** (включая количество порций) для каждого человека.
5. **Пользователь нажимает "Разделить чек"** и всем зарегистированным пользователям добавляется счет в список "Мои счета". Пользователь может скопировать в текстовом формате список людей с их суммами.
 
 *Интегрировав этот функционал, например, с банковкским приложением, пользователь сможет одним кликом перевести нужную сумму тому, кто оплатил весь ужин. Приложение на Android или IOS может отправить уведомление*

## Документация

Документация к API: [тут](https://api.deli-check.ru/swagger/index.html)

Схемы:
<div align="center">

![](https://raw.githubusercontent.com/anden-t/DeliCheck/refs/heads/main/Docs/%D0%90%D1%80%D1%85%D0%B8%D1%82%D0%B5%D0%BA%D1%82%D1%83%D1%80%D0%B0%20%D0%BF%D1%80%D0%B8%D0%BB%D0%BE%D0%B6%D0%B5%D0%BD%D0%B8%D1%8F.png)
<br/>Архитектура приложения<br/><br/><br/>
![](https://raw.githubusercontent.com/anden-t/DeliCheck/refs/heads/main/Docs/%D0%90%D1%80%D1%85%D0%B8%D1%82%D0%B5%D0%BA%D1%82%D1%83%D1%80%D0%B0%20API.png)
<br/>Архитектура API<br/><br/><br/>
![](https://raw.githubusercontent.com/anden-t/DeliCheck/refs/heads/main/Docs/%D0%90%D0%BB%D0%B3%D0%BE%D1%80%D0%B8%D1%82%D0%BC%20%D1%80%D0%B0%D1%81%D0%BF%D0%BE%D0%B7%D0%BD%D0%B0%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F%20%D1%87%D0%B5%D0%BA%D0%B0.png)
<br/>Алгоритм распознавания чека<br/><br/><br/>

</div>

Авторы:
 - Толмачев Денис Михайлович
 - Толмачев Андрей Михайлович
 - Аксенов Владислав Владимирович
 - Михайлов Александр Андреевич

*Команда ЮЗГУ https://swsu.ru*
